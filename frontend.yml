- name: INSTALLING NGINX SERVER
  hosts: all
  become: yes
  tasks:
    - name: Install the latest version of Apache
      ansible.builtin.yum:
        name: nginx
        state: latest

    - name: REMOVING OLD APP CONTENT
      ansible.builtin.file:
        path: /usr/share/nginx/html
        state: absent

      name: EXTRACT FRONTEND CONTENT
      ansible.builtin.file:
        path: usr/share/nginx/html
        state: directory

      name: DOWNLOAD AND EXTRACT FRONTEND CONTENT
      ansible.builtin.unarchive:
          src: https://roboshop-artifacts.s3.amazonaws.com/frontend.zip
          dest: /usr/share/nginx/html
          remote_src: yes

      name: Copy roboshop configuratiom
      ansible.builtin.copy:
          src: roboshop.conf
          dest: /etc/nginx/default.d/roboshop.conf

      name: STARTING NGINX SERVER
      ansible.builtin.systemd:
          state: restarted
          name: nginx
          enabled: true



















#echo -e "\e[33mINSTALLING NGINX SERVER\e[0m"
#yum install nginx -y &>>/tmp/roboshop.log # this cmd(>/tmp/roboshop.log) meaning we are storing output in robishop.log file

#echo -e "\e[33mREMOVING OLD APP CONTENT\e[0m"
#rm -rf /usr/share/nginx/html/* &>>/tmp/roboshop.log

#echo -e "\e[33mDOWNLOADING FRONTEND CONTENT\e[0m"
#curl -o /tmp/frontend.zip https://roboshop-artifacts.s3.amazonaws.com/frontend.zip &>>/tmp/roboshop.log

#echo -e "\e[33mEXTRACT FRONTEND CONTENT\e[0m"
#cd /usr/share/nginx/html
#unzip /tmp/frontend.zip &>>/tmp/roboshop.log

  # we need to create config file

#cho -e "\e[33mSTARTING NGINX SERVER\e[0m"
#systemctl enable nginx &>>/tmp/roboshop.log
#systemct restart nginx &>>/tmp/roboshop.log